#!/bin/bash
# load_db.sh.in
#
# This file is released under the terms of the Artistic License.  Please see
# the file LICENSE, included in this package, for details.
#
# Copyright (C) 2002 Open Source Development Lab, Inc.
# History:
# June-4-2003 Create by Jenny Zhang

. @TOPDIR@/scripts/dbt3_profile || exit 1

TABLESPACES=${1}

echo "Loading table tables... "

date
if [ ${TABLESPACES} -eq 1 ]; then
	@PSQL@ -d $SID -c "COPY supplier FROM '$DSS_PATH/supplier.tbl' USING DELIMITERS '|';" || exit 1 &
	@PSQL@ -d $SID -c "COPY part FROM '$DSS_PATH/part.tbl' USING DELIMITERS '|';" || exit 1 &
	@PSQL@ -d $SID -c "COPY partsupp FROM '$DSS_PATH/partsupp.tbl' USING DELIMITERS '|';" || exit 1 &
	@PSQL@ -d $SID -c "COPY customer FROM '$DSS_PATH/customer.tbl' USING DELIMITERS '|';" || exit 1 &
	@PSQL@ -d $SID -c "COPY orders FROM '$DSS_PATH/orders.tbl' USING DELIMITERS '|';" || exit 1 &
	@PSQL@ -d $SID -c "COPY lineitem FROM '$DSS_PATH/lineitem.tbl' USING DELIMITERS '|';" || exit 1 &
	@PSQL@ -d $SID -c "COPY nation FROM '$DSS_PATH/nation.tbl' USING DELIMITERS '|';" || exit 1 &
	@PSQL@ -d $SID -c "COPY region FROM '$DSS_PATH/region.tbl' USING DELIMITERS '|';" || exit 1 &
else
	@PSQL@ -d $SID -c "COPY supplier FROM '$DSS_PATH/supplier.tbl' USING DELIMITERS '|';" || exit 1
	@PSQL@ -d $SID -c "COPY part FROM '$DSS_PATH/part.tbl' USING DELIMITERS '|';" || exit 1
	@PSQL@ -d $SID -c "COPY partsupp FROM '$DSS_PATH/partsupp.tbl' USING DELIMITERS '|';" || exit 1
	@PSQL@ -d $SID -c "COPY customer FROM '$DSS_PATH/customer.tbl' USING DELIMITERS '|';" || exit 1
	@PSQL@ -d $SID -c "COPY orders FROM '$DSS_PATH/orders.tbl' USING DELIMITERS '|';" || exit 1
	@PSQL@ -d $SID -c "COPY lineitem FROM '$DSS_PATH/lineitem.tbl' USING DELIMITERS '|';" || exit 1
	@PSQL@ -d $SID -c "COPY nation FROM '$DSS_PATH/nation.tbl' USING DELIMITERS '|';" || exit 1
	@PSQL@ -d $SID -c "COPY region FROM '$DSS_PATH/region.tbl' USING DELIMITERS '|';" || exit 1
fi

wait

exit 0
