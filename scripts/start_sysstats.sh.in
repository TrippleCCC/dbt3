#!/bin/sh
#
# This file is released under the terms of the Artistic License.  Please see
# the file LICENSE, included in this package, for details.
#
# Copyright (C) 2002 Mark Wong & Open Source Development Lab, Inc.
#
# 17 october 2002

# Set the relative execution prefix

SAMPLE_LENGTH=60
while getopts "o:p:s:" opt; do
	case $opt in
		o)
			OUTPUT_DIR=$OPTARG
			;;
		p)
			PREFIX=$OPTARG
			;;
		s)
			SAMPLE_LENGTH=$OPTARG
			;;
	esac
done

SARDIR=$OUTPUT_DIR/sar
IOSTATDIR=$OUTPUT_DIR/iostat
VMSTATDIR=$OUTPUT_DIR/vmstat

mkdir -p $SARDIR
mkdir -p $IOSTATDIR
mkdir -p $VMSTATDIR

@SAR@ -o $SARDIR/$PREFIX.sar.out $SAMPLE_LENGTH 0 &

@IOSTAT@ -d $SAMPLE_LENGTH  >> $IOSTATDIR/$PREFIX.iostat.out &
@IOSTAT@ -d -x $SAMPLE_LENGTH  >> $IOSTATDIR/$PREFIX.iostatx.out &

@VMSTAT@ -n $SAMPLE_LENGTH >> $VMSTATDIR/$PREFIX.vmstat.out &
